$(document).ready(function(){var e={modal:$("#editOrAddModal"),listContainer:$(".js_table_list"),progress:$(".js_progress_section"),progressBar:$(".progress-bar"),inputTitle:$("#js_modal_title"),inputContent:$("#js_modal_content"),inputType:$("#js_modal_type"),inputBtnName:$("#js_modal_btn_name"),inputUrl:$("#js_modal_url"),setModalFormData:function(t){var n=e.modal.find(".modal-title");n.html(n.data("edit")),e.inputTitle.val(t.title),e.inputBtnName.val(t.btn_name),e.inputContent.val(t.content),e.inputType.val(t.lock_type_id),e.inputUrl.val(t.url)},clearModalFormData:function(){var t=e.modal.find(".modal-title");t.html(t.data("new")),e.inputTitle.val(""),e.inputBtnName.val(""),e.inputContent.val(""),e.inputType.val(0),e.inputUrl.val("")},initBtnEvent:function(){$(document).on("click",".js_edit",function(){e.clearModalFormData();var t=e.modal.find(".js_submit"),n=$(this),r=n.parents("tr"),i=r.data("id"),s=r.data("info");i&&s&&e.setModalFormData(s),e.modal.modal(),t.unbind().bind("click",function(){var t={id:i,title:$.trim(e.inputTitle.val()),btn_name:$.trim(e.inputBtnName.val()),content:$.trim(e.inputContent.val()),type_id:$.trim(e.inputType.val()),url:$.trim(e.inputUrl.val())},n={title:"请输入名称",btn_name:"请输入下载按钮名称",content:"请填写描述",url:"请上传下载文件"};for(var s in n)if(!t[s])return $.showToast(n[s],!1),!1;$.wpost("/lock/update-download-ajax",t,function(n){t.id?r.replaceWith(n):e.listContainer.append(n),$.showToast("保存成功",!0),e.modal.modal("hide")})})}),$(document).on("click",".js_delete",function(){var e=$(this),t=e.parents("tr"),n=t.attr("data-id");$.confirm({content:"确认删除吗",success:function(){$.wpost("/lock/delete-download-ajax",{id:n},function(){$.showToast("删除成功",!0),e.parents("tr").remove()})}})}),$(".js_upload_image").unbind().bind("click",function(){$(this).uploadImage("/upload/upload-image",{request_type:"ajax",type:1},function(t){t.res?e.inputUrl.val(t.path):$.showToast(t.desc,!1),e.progress.addClass("gone")},function(t){t>=0&&e.progress.removeClass("gone"),e.progressBar.css("width",t+"%")})})},run:function(){e.initBtnEvent()}};e.run()});